# Exercice 2 : Partie II - Requ√™tes interm√©diaires

## Questions (8 questions)

**1. Calculer le nombre de sports pratiqu√©s par chaque sportif**

Affichez le nom du sportif et le nombre de sports.

<details>
<summary>üí° Indice</summary>

Comptez les entr√©es dans `Jouer` en groupant par NumLicence, puis joignez avec `Sportif`.
</details>

**2. Afficher les sports par niveau de comp√©tence des pratiquants**

Pour chaque sport, affichez le nombre de d√©butants, confirm√©s, etc.

<details>
<summary>üí° Indice</summary>

Utilisez `GROUP BY NumSport` et `CASE` ou `COUNT()` avec des conditions sur le champ Niveau.
</details>

**3. Trouver les sportifs qui ont le plus de niveaux diff√©rents (polyvalents)**

<details>
<summary>üí° Indice</summary>

Comptez les niveaux distincts par sportif (en combinant Jouer, Entrainer, Arbitrer), puis trouvez le maximum.
</details>

**4. Calculer le nombre d'entra√Æneurs par sport**

<details>
<summary>üí° Indice</summary>

Comptez les entr√©es distinctes dans `Entrainer` en groupant par NumSport.
</details>

**5. Afficher les sports avec au moins 5 pratiquants de niveau "Confirm√©"**

<details>
<summary>üí° Indice</summary>

Filtrez `Jouer` o√π Niveau = "Confirm√©", comptez, et appliquez HAVING pour le minimum de 5.
</details>

**6. Lister les gymnases avec le nombre total de s√©ances et le nombre de sports distincts offerts**

<details>
<summary>üí° Indice</summary>

Comptez les s√©ances et les sports distincts en groupant par NumGymnase.
</details>

**7. Afficher les sportifs qui peuvent jouer dans une s√©ance donn√©e (ex: NumSeance = "101")**

Basez-vous sur les sports de la s√©ance et les sports que le sportif pratique.

<details>
<summary>üí° Indice</summary>

Trouvez d'abord le sport de la s√©ance, puis les sportifs qui pratiquent ce sport.
</details>

**8. Calculer le nombre moyen de sportifs par s√©ance pour chaque gymnase**

<details>
<summary>üí° Indice</summary>

Utilisez le champ `MaxSportifs` dans `Seance` et groupez par gymnase (ou comptez les participants r√©els).
</details>

2. **Supprimer les produits qui ne se sont jamais vendus**

```sql
DELETE FROM Produits
WHERE IdProduit NOT IN (SELECT DISTINCT IdProduit FROM Details);
```

3. **Supprimer les clients inactifs** (sans commande depuis plus de 2 ans)

```sql
DELETE FROM Clients
WHERE IdClient NOT IN (
    SELECT DISTINCT IdClient FROM Commandes 
    WHERE DateCommande > DATE('now', '-2 years')
);
```

4. **Nettoyer les d√©tails de commande avec quantit√© z√©ro**

```sql
DELETE FROM Details
WHERE Quantite = 0;
```

5. **Supprimer une cat√©gorie de produits vide**

```sql
DELETE FROM Categories
WHERE IdCategorie NOT IN (SELECT DISTINCT IdCategorie FROM Produits);
```

## Points √† retenir

- DELETE sans WHERE supprime TOUTES les lignes !
- Toujours v√©rifier avec SELECT avant de DELETE
- Les contraintes d'int√©grit√© peuvent bloquer la suppression
- Sauvegarder avant les op√©rations de masse

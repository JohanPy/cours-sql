# Exercice 1 : Jointures

## Questions

**1. Afficher toutes les commandes avec les informations du client et de l'employ√©**

Pour chaque commande, affichez le num√©ro, la date, le nom du client et le nom de l'employ√© qui l'a trait√©e.

<details>
<summary>üí° Indice</summary>

Utilisez `INNER JOIN Commande` avec `Client` sur `CodeCli` et `Employe` sur `NoEmp`.
</details>

**2. Lister tous les produits avec leur cat√©gorie et leur fournisseur**

Affichez le nom du produit, la cat√©gorie et le fournisseur.

<details>
<summary>üí° Indice</summary>

Joignez `Produit` avec `Categorie` (sur CodeCategorie) et `Fournisseur` (sur CodeFournisseur).
</details>

**3. Afficher les d√©tails de toutes les commandes avec les noms des produits**

Pour chaque ligne de commande, affichez le num√©ro de commande, la r√©f√©rence du produit et son nom.

<details>
<summary>üí° Indice</summary>

Joignez `DetailCommande` avec `Produit` sur `Refprod`.
</details>

**4. Trouver les clients qui n'ont jamais command√© (LEFT JOIN)**

Affichez les clients de la base qui n'ont aucune commande enregistr√©e.

<details>
<summary>üí° Indice</summary>

Utilisez `LEFT JOIN Commande` et filtrez avec `WHERE NoCom IS NULL`.
</details>

**5. Afficher tous les produits, qu'ils aient √©t√© command√©s ou non**

Affichez le nom du produit et le nombre de fois qu'il a √©t√© command√© (0 si jamais command√©).

<details>
<summary>üí° Indice</summary>

Utilisez `LEFT JOIN DetailCommande` avec `GROUP BY` et `COUNT()`.
</details>

**6. Lister les employ√©s et leurs responsables (auto-jointure)**

Pour chaque employ√©, affichez son nom et le nom de son responsable.

<details>
<summary>üí° Indice</summary>

Joignez la table `Employe` avec elle-m√™me : `e` et `e_chef`. La liaison est sur le champ `Responsable`.
</details>

**7. Afficher les commandes group√©es avec client, employ√©, et informations compl√®tes**

Pour chaque commande : client, employ√©, nombre de produits et montant total (avec remise).

<details>
<summary>üí° Indice</summary>

Joignez `Commande`, `Client`, `Employe`, `DetailCommande` et agr√©gez avec `SUM()` et `COUNT()`.
</details>

**8. Trouver les clients et les fournisseurs du m√™me pays**

Affichez les paires client-fournisseur pour chaque pays.

<details>
<summary>üí° Indice</summary>

Joignez `Client` et `Fournisseur` sur le champ `Pays` (CROSS JOIN avec condition).
</details>

**9. Afficher les commandes avec d√©lai de livraison (DateLivraison - DateCom)**

Affichez le num√©ro de commande, la date de commande, la date de livraison et le d√©lai en jours.

<details>
<summary>üí° Indice</summary>

Calculez `CAST(JULIANDAY(DateLivraison) - JULIANDAY(DateCom) AS INTEGER)` dans votre SELECT.
</details>

**10. Cr√©er un r√©sum√© complet : client ‚Üí commandes ‚Üí produits avec tous les d√©tails**

Affichez pour chaque commande : Societe, DateCom, NoCom, Nomprod, Qte, Remise, montant ligne.

<details>
<summary>üí° Indice</summary>

Joignez les 4 tables principales : `Client`, `Commande`, `DetailCommande`, `Produit`.
</details>
       SUM(d.Quantite * d.PrixUnitaire) AS VenteMois,
       SUM(SUM(d.Quantite * d.PrixUnitaire)) OVER (ORDER BY strftime('%Y-%m', co.DateCommande)) AS TotalCumul√©
FROM Commandes co
JOIN Details d ON co.IdCommande = d.IdCommande
GROUP BY strftime('%Y-%m', co.DateCommande);
```

```sql
SELECT c.NomSociete, strftime('%Y-%m', co.DateCommande) AS Mois,
       SUM(d.Quantite * d.PrixUnitaire) AS VenteMois,
       AVG(SUM(d.Quantite * d.PrixUnitaire)) OVER (PARTITION BY c.IdClient ORDER BY strftime('%Y-%m', co.DateCommande) ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS MovingAvg
FROM Clients c
JOIN Commandes co ON c.IdClient = co.IdClient
JOIN Details d ON co.IdCommande = d.IdCommande
GROUP BY c.IdClient, Mois;
```

```sql
SELECT strftime('%Y-%m', co.DateCommande) AS Mois,
       SUM(d.Quantite * d.PrixUnitaire) AS VenteActuelle,
       LAG(SUM(d.Quantite * d.PrixUnitaire)) OVER (ORDER BY strftime('%Y-%m', co.DateCommande)) AS VentePrecedente
FROM Commandes co
JOIN Details d ON co.IdCommande = d.IdCommande
GROUP BY strftime('%Y-%m', co.DateCommande);
```
